if exist('purge') > 0
    purge
end

[cDirThis, cName, cExt] = fileparts(mfilename('fullpath'));
cDirSrc = fullfile(cDirThis, '..', '..', 'src');
cDirVendor = fullfile(cDirThis, '..', '..', 'vendor');

% Add src
addpath(genpath(cDirSrc));

% Add dependencies 
addpath(genpath(fullfile(cDirVendor, 'github', 'cnanders', 'matlab-npoint-lc400', 'src')));
addpath(genpath(fullfile(cDirVendor, 'github', 'cnanders', 'matlab-instrument-control', 'src')));

% Optionally configure with the directory where waveforms are saved
% The default is to use pwd

cDir = fullfile( ...
    cDirThis, ...
    'save' ...
);

dScreenSize = get(0, 'ScreenSize');
        
dWidth = 600;
dHeight = 500;

hFigure = figure( ...
    'NumberTitle', 'off', ...
    'MenuBar', 'none', ...
    'Name', 'LC400 Test', ...
    'Position', [ ...
        (dScreenSize(3) - dWidth)/2 ...
        (dScreenSize(4) - dHeight)/2 ...
        dWidth ...
        dHeight ...
     ]... % left bottom width height
);

clock = mic.Clock('master'); 
app = npoint.ui.LC400(...
    'clock', clock, ...
    'fhGet20BitWaveforms', @get20BitWaveforms, ...
    'cName', 'Test' ...
);
app.build(hFigure, 10, 10);